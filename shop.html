---
layout: default
title: KEICHA 網路商店
---

<div class="max-w-screen-xl mx-auto px-6 py-12">
  <header class="flex justify-between items-center mb-16">
    <div class="flex items-center gap-4">
      <img src="{{ '/assets/images/logo.png' | relative_url }}" class="h-12" alt="KEICHA">
      <h1 class="text-2xl font-black text-gray-800 tracking-tighter">KEICHA</h1>
    </div>
    
    <div class="flex items-center gap-6">
      <div id="top-auth-zone">
        <div class="h-10 w-24 bg-gray-100 animate-pulse rounded-2xl"></div>
      </div>
      
      <button onclick="window.openCart()" class="relative p-3 bg-white shadow-sm border border-gray-100 rounded-2xl hover:scale-110 transition active:scale-95">
        <span class="material-symbols-rounded text-gray-700">shopping_basket</span>
        <span id="cart-count" class="absolute -top-1 -right-1 bg-[#6ea44c] text-white text-[10px] font-bold w-5 h-5 flex items-center justify-center rounded-full hidden">0</span>
      </button>
    </div>
  </header>

  <main id="category-container" class="space-y-20 min-h-[60vh]">
    <div id="products-loader" class="flex flex-col items-center py-40 text-gray-300">
      <span class="material-symbols-rounded animate-spin-custom text-4xl mb-4">sync</span>
      <p class="font-bold tracking-widest text-sm">讀取中...</p>
    </div>
  </main>
</div>

<div id="global-overlay" class="overlay" onclick="window.closeAllPanels()"></div>

{% include panel-login.html %}
{% include panel-user.html %}
{% include panel-cart.html %}
{% include panel-checkout.html %}

<script>
window.ITEM_CARD_TEMPLATE = (p, img, isSoldOut) => `
  <div class="product-card group ${isSoldOut ? 'opacity-60 grayscale' : ''}">
    <div class="relative overflow-hidden rounded-[2.5rem] mb-6 aspect-square bg-gray-50">
      <img src="${img}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700">
      ${isSoldOut ? '<div class="absolute inset-0 flex items-center justify-center bg-black/20 text-white font-black text-xl tracking-widest">SOLD OUT</div>' : ''}
    </div>
    <div class="px-2">
      <div class="text-[10px] brand-green font-bold uppercase tracking-widest mb-2">${p.category || ''}</div>
      <h3 class="font-bold text-gray-800 text-lg mb-4 line-clamp-1">${p.product_name}</h3>
      <div class="flex items-center justify-between gap-4">
        <div class="text-xl font-black text-gray-900 font-mono">NT$ ${p.price.toLocaleString()}</div>
        ${!isSoldOut ? `
        <div class="flex items-center gap-3">
          <div class="qty-control">
            <button onclick="window.adjQty('${p.product_id}', -1)" class="qty-btn">-</button>
            <span id="iq-${p.product_id}" class="text-sm font-bold w-4 text-center">1</span>
            <button onclick="window.adjQty('${p.product_id}', 1)" class="qty-btn">+</button>
          </div>
          <button onclick="window.addToCart('${p.product_id}')" class="bg-[#6ea44c] text-white p-3 rounded-2xl hover:bg-[#5a8a3c] transition shadow-lg">
            <span class="material-symbols-rounded text-xl">add_shopping_cart</span>
          </button>
        </div>` : ''}
      </div>
    </div>
  </div>
`;

window.adjQty = (pid, d) => {
    const el = document.getElementById(`iq-${pid}`);
    if(!el) return;
    let v = parseInt(el.innerText) + d;
    if(v >= 1) el.innerText = v;
};
</script>

<script src="{{ '/assets/js/shop-logic.js' | relative_url }}"></script>

<style>
  .animate-spin-custom { animation: spin 1.5s linear infinite; }
  @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
  .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 3rem 2rem; }
  .qty-control { display: flex; align-items: center; background: #f8f9fa; border-radius: 1rem; padding: 2px; }
  .qty-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #666; }
</style>
